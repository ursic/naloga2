<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk">
  <h:head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <f:view locale="#{naloga2.locale}">
      <title>#{lang['task2']}</title>
    </f:view>
    <link href="./css/naloga2.css" rel="stylesheet" type="text/css" />
  </h:head>
  <script type="text/javascript" src="./js/jquery-2.0.3.min.js"></script>
  <h:body>
    <f:view locale="#{naloga2.locale}">

      <h2><a href="/">#{lang['list']}</a></h2>
      <div class="error">
        <img class="loader" src="./img/loader.gif" width="24" />
        <span class="errorText">#{naloga2.errorMsg}</span>
      </div>
      
      <h:form rendered="#{naloga2.isDataValid}">
        #{lang['num_vehicles']}: #{naloga2.numVehicles}

        <h:dataTable value="#{naloga2.vehicles}" var="vehicle"
                     styleClass="employeeTable"
                     headerClass="employeeTableHeader"
                     rowClasses="employeeTableRowOdd,employeeTableRowEven"
                     columnClasses="checkBox,dbState,colMiddle,colMiddle,colMiddle,colMiddle,colPrice">
          <h:column headerClass="employeeTableHeader selectHeader">
            <f:facet name="header"><h:selectBooleanCheckbox name="selectAll" id="selectAll" /></f:facet>
            <h:selectBooleanCheckbox
               name="select"
               value="#{naloga2.checkedVehicles[vehicle.hash]}"
               rendered="#{!naloga2.vehiclesInDb[vehicle.hash]}" />
          </h:column>
          <h:column headerClass="employeeTableHeader dbHeader">
            <f:facet name="header">#{lang['in_database']}</f:facet>
            <h:outputText value="#{lang['yes']}" rendered="#{naloga2.vehiclesInDb[vehicle.hash]}" />
            <h:outputText value="#{lang['no']}" rendered="#{!naloga2.vehiclesInDb[vehicle.hash]}" />
          </h:column>
          <h:column headerClass="employeeTableHeader yearHeader headerMiddle">
            <f:facet name="header">#{lang['year']}</f:facet>
            #{vehicle.year}
          </h:column>
          <h:column headerClass="employeeTableHeader headerMiddle">
            <f:facet name="header">#{lang['make']}</f:facet>
            #{vehicle.make}
          </h:column>
          <h:column headerClass="employeeTableHeader headerMiddle">
            <f:facet name="header">#{lang['model']}</f:facet>
            #{vehicle.model}
          </h:column>
          <h:column headerClass="employeeTableHeader headerMiddle">
            <f:facet name="header">#{lang['comment']}</f:facet>
            #{vehicle.comment}
          </h:column>
          <h:column headerClass="employeeTableHeader headerMiddle">
            <f:facet name="header">#{lang['price']}</f:facet>
            <h:outputText value="#{vehicle.price}">
              <f:convertNumber pattern="0.00" />
            </h:outputText>
          </h:column>
        </h:dataTable>
        <h:commandButton value="#{lang['store']}"
                         action="#{naloga2.storeVehicles}"
                         styleClass="storeButton"
                         disabled="#{!naloga2.anyInFile}" 
                         update="@form" />
        <h:commandButton value="#{lang['empty_database']}"
                         action="#{naloga2.removeVehicles}"
                         styleClass="emptyButton"
                         disabled="#{!naloga2.anyInDb}" />
      </h:form>

      <h:button id="browseButton" value="#{lang['browse']}" onclick="return false;" />
      <h:form enctype="multipart/form-data" styleClass="uploadForm">
        <t:inputFileUpload id="fileInput" value="#{naloga2.uploadedFile}" style="display: none" />
        <h:commandButton class="uploadButton" value="#{lang['upload']}" action="#{naloga2.upload}" />
        <h:panelGroup class="fileText" layout="block" />
      </h:form>
      <h:form>
        <h:commandButton class="langButton" value="#{lang['lang']}" action="#{naloga2.changeLanguage}" />
      </h:form>
      <script type="text/javascript" src="./js/naloga2.js"></script>
    </f:view>
  </h:body>
</html>
